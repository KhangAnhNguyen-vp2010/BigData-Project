ğŸ›« Flight Data Realtime Dashboard & Analysis
ğŸ“˜ Giá»›i thiá»‡u

Dá»± Ã¡n nÃ y xÃ¢y dá»±ng má»™t há»‡ thá»‘ng trá»±c quan hÃ³a vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u chuyáº¿n bay theo thá»i gian thá»±c, sá»­ dá»¥ng:

-RethinkDB Ä‘á»ƒ lÆ°u trá»¯ vÃ  stream dá»¯ liá»‡u realtime

-Streamlit Ä‘á»ƒ hiá»ƒn thá»‹ dashboard

-PySpark Ä‘á»ƒ phÃ¢n tÃ­ch vÃ  huáº¥n luyá»‡n mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n sá»‘ chuyáº¿n bay trong giá» káº¿ tiáº¿p

Dá»± Ã¡n Ä‘Æ°á»£c chia lÃ m 3 pháº§n chÃ­nh:

1. Realtime Dashboard â€” hiá»ƒn thá»‹ dá»¯ liá»‡u chuyáº¿n bay Ä‘ang diá»…n ra theo thá»i gian thá»±c

2. Spark Analysis Dashboard â€” phÃ¢n tÃ­ch dá»¯ liá»‡u chuyáº¿n bay vÃ  xu hÆ°á»›ng theo giá»

3. Flight Prediction â€” huáº¥n luyá»‡n mÃ´ hÃ¬nh vÃ  dá»± Ä‘oÃ¡n sá»‘ chuyáº¿n bay giá» káº¿ tiáº¿p

ğŸ§± Cáº¥u trÃºc thÆ° má»¥c
BigData_DoAn/
â”‚
â”œâ”€â”€ analysis.py               # PhÃ¢n tÃ­ch dá»¯ liá»‡u vá»›i Spark (summary + trend)
â”œâ”€â”€ predict.py                # Huáº¥n luyá»‡n mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n sá»‘ chuyáº¿n bay
â”œâ”€â”€ dashboard.py              # Trang dashboard chÃ­nh (Spark + Prediction)
â”œâ”€â”€ realtime_page.py          # Trang hiá»ƒn thá»‹ dá»¯ liá»‡u realtime (RethinkDB changes)
â”œâ”€â”€ app.py                    # Äiá»ƒm vÃ o chÃ­nh, quáº£n lÃ½ cÃ¡c trang
â”‚
â”œâ”€â”€ output_flight_summary.csv # Káº¿t quáº£ tá»•ng há»£p top quá»‘c gia (Spark)
â”œâ”€â”€ output_flight_trend.csv   # Káº¿t quáº£ xu hÆ°á»›ng chuyáº¿n bay (Spark)
â”‚
â”œâ”€â”€ requirements.txt          # Danh sÃ¡ch thÆ° viá»‡n cáº§n cÃ i
â””â”€â”€ README.md                 # TÃ i liá»‡u hÆ°á»›ng dáº«n nÃ y

âš™ï¸ CÃ i Ä‘áº·t mÃ´i trÆ°á»ng
1ï¸âƒ£ Clone dá»± Ã¡n
git clone https://github.com/<your-username>/FlightDashboard.git
cd FlightDashboard

2ï¸âƒ£ CÃ i cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t

Náº¿u báº¡n Ä‘Ã£ cÃ³ file requirements.txt:

pip install -r requirements.txt


hoáº·c náº¿u chÆ°a cÃ³:

pip install streamlit rethinkdb pandas plotly pyspark scikit-learn

3ï¸âƒ£ Khá»Ÿi Ä‘á»™ng RethinkDB
rethinkdb


Sau Ä‘Ã³ má»Ÿ trÃ¬nh duyá»‡t táº¡i:

http://localhost:8080


Táº¡o database vÃ  table náº¿u chÆ°a cÃ³:

-Database: flights_db

-Tables: flights

ğŸš€ Cháº¡y á»©ng dá»¥ng

â–¶ï¸ 1. Tiáº¿n hÃ nh thu tháº­p dá»¯ liá»‡u vÃ o RethinkDB (náº¿u chÆ°a cÃ³ dá»¯ liá»‡u)
python collector.py

â–¶ï¸ 2. Cháº¡y trang chÃ­nh
streamlit run app.py

â–¶ï¸ 3. (TÃ¹y chá»n) Cháº¡y phÃ¢n tÃ­ch dá»¯ liá»‡u thá»§ cÃ´ng
python analysis.py

â–¶ï¸ 4. (TÃ¹y chá»n) Cháº¡y dá»± Ä‘oÃ¡n thá»§ cÃ´ng
python predict.py

ğŸ§  CÃ¡c tÃ­nh nÄƒng chÃ­nh
ğŸ›°ï¸ 1. Realtime Flights Page

-Láº¥y dá»¯ liá»‡u trá»±c tiáº¿p tá»« RethinkDB (flights table)

-Hiá»ƒn thá»‹ top quá»‘c gia cÃ³ nhiá»u chuyáº¿n bay nháº¥t

-Cáº­p nháº­t báº£n Ä‘á»“ vá»‹ trÃ­ mÃ¡y bay realtime

-Tá»± Ä‘á»™ng reload khi cÃ³ thay Ä‘á»•i má»›i trong database (sá»­ dá»¥ng changes())

ğŸ“Š 2. Spark Analysis Page

-PhÃ¢n tÃ­ch dá»¯ liá»‡u báº±ng PySpark:

 +Tá»•ng há»£p top quá»‘c gia cÃ³ nhiá»u chuyáº¿n bay nháº¥t

 +PhÃ¢n tÃ­ch xu hÆ°á»›ng chuyáº¿n bay theo giá»

-Cho phÃ©p báº¥m nÃºt "PhÃ¢n tÃ­ch láº¡i" Ä‘á»ƒ cháº¡y láº¡i analysis.py ngay trong giao diá»‡n

-Hiá»ƒn thá»‹ káº¿t quáº£ tá»« file CSV (output_flight_summary.csv, output_flight_trend.csv)

â° 3. Flight Prediction Page

-Sá»­ dá»¥ng mÃ´ hÃ¬nh RandomForestRegressor Ä‘á»ƒ dá»± Ä‘oÃ¡n sá»‘ chuyáº¿n bay cá»§a giá» káº¿ tiáº¿p

-Cho phÃ©p ngÆ°á»i dÃ¹ng nháº¥n nÃºt â€œDá»± Ä‘oÃ¡n ngayâ€ Ä‘á»ƒ huáº¥n luyá»‡n & dá»± Ä‘oÃ¡n trá»±c tiáº¿p

-Hiá»ƒn thá»‹ biá»ƒu Ä‘á»“ dá»± Ä‘oÃ¡n theo thá»i gian

ğŸ“‚ Dá»¯ liá»‡u máº«u

Dá»¯ liá»‡u Ä‘Æ°á»£c láº¥y tá»« flights table trong RethinkDB.
VÃ­ dá»¥ dá»¯ liá»‡u Ä‘Ã£ qua xá»­ lÃ½ lÆ°u trong output_flight_trend.csv:

hour_slot,flights_per_hour
2025-10-10 13:00:00,33000
2025-10-10 14:00:00,14000

ğŸ§© YÃªu cáº§u há»‡ thá»‘ng
ThÃ nh pháº§n	PhiÃªn báº£n khuyáº¿n nghá»‹
-Python	>= 3.10
-RethinkDB	>= 2.4
-Streamlit	>= 1.38
-PySpark	>= 3.5
-Plotly	>= 5.20
ğŸ’¬ Ghi chÃº thÃªm

-Náº¿u báº¡n dÃ¹ng Windows, Ä‘áº£m báº£o Ä‘Ã£ cÃ i Ä‘áº·t Java (JDK) trÆ°á»›c khi dÃ¹ng PySpark.

-Náº¿u gáº·p lá»—i Unicode trong console, hÃ£y dÃ¹ng mÃ£ lá»‡nh sau trong script:

import sys, io
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')


-NÃªn táº¡o mÃ´i trÆ°á»ng áº£o Ä‘á»ƒ trÃ¡nh xung Ä‘á»™t thÆ° viá»‡n:

python -m venv venv
venv\Scripts\activate

âœ¨ Demo Ã½ tÆ°á»Ÿng
      Trang	         |   MÃ´ táº£
-Realtime Flights	 | Hiá»ƒn thá»‹ dá»¯ liá»‡u chuyáº¿n bay trá»±c tiáº¿p
-Spark Analysis	     | PhÃ¢n tÃ­ch & thá»‘ng kÃª dá»¯ liá»‡u báº±ng PySpark
-Flight Prediction	 | Dá»± Ä‘oÃ¡n sá»‘ chuyáº¿n bay giá» káº¿ tiáº¿p
ğŸ‘¨â€ğŸ’» TÃ¡c giáº£

CÆ°á»i Táº¡i â€” Dá»± Ã¡n Big Data Realtime vá»›i RethinkDB + PySpark + Streamlit.
Náº¿u báº¡n tháº¥y dá»± Ã¡n há»¯u Ã­ch, hÃ£y â­ï¸ nÃ³ trÃªn GitHub nhÃ©!